<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security" th:fragment="header">
<style>
	#menu li ul {list-style: none; margin: 0; padding: 0;}
	.main-menu:hover .sub-menu {display: none;}
	.sub-menu {display: none;}
	.sub-menu li {padding: 0px !important;}
</style>
<header>
	<div id="menu-toggle">
		<input type="checkbox" />
		<span></span>
		<span></span>
		<span></span>
		
		<ul id="menu">
			<li><a th:href="@{/}">Main</a></li>
			<li><a th:href="@{/deploy}">Deploy Info</a></li>
			<li><a th:href="@{/aboutme}">About Me</a></li>
			<li><a th:href="@{/board/list(code='B002')}">Study</a></li>
			<li><a th:href="@{/board/list(code='B005')}">Daily</a></li>
			<li><a th:href="@{/board/list(code='B004')}">Music</a></li>
			<!--
			<th:block sec:authorize="hasRole('ADMIN')"><li><a th:href="@{/board/list(code='B007')}">Data</a></li></th:block>
			-->
			<!-- 토글 방식 -->
			<th:block sec:authorize="hasRole('ADMIN')">
				<li class="main-menu">
					<a href="#" class="submenu-toggle">Admin</a>
					<ul class="sub-menu">
						<li><a th:href="@{/admin/visit}">Visit Logs</a></li>
					</ul>
				</li>
			</th:block>
			<th:block sec:authorize="isAnonymous()"><li><a th:href="@{/login}">Login</a></li></th:block>
			<th:block sec:authorize="isAuthenticated()"><li><a th:href="@{/logout}">Logout</a></li></th:block>
		</ul>
	</div>
	
	<div id="homepage-title"><a th:href="@{/}">HOMEPAGE</a></div>
</header>
<div class="guide-bar"></div>

<script>
$(document).ready(function () {
    const $header        = $('header');
    const $guideBar      = $('.guide-bar');
    const $section       = $('section');
	const $submenuToggle = $('.submenu-toggle');
	
    $(window).on('scroll', function () {
    	const $windowWidth     = $(window).width();
        const $windowHeight	   = $(window).height();
        const $docHeight	   = $(document).height();
        const $scrollTop	   = $(this).scrollTop();
        const $scrollThreshold = $windowWidth > 768 ? 200 : 100;
        const $scrollProgress  = ($scrollTop / ($docHeight - $windowHeight)) * 100;
        
        $guideBar.css('width', $scrollProgress + '%');
        
        // header 색상 변경 이벤트
        if ($scrollTop > $scrollThreshold) {
            $header.addClass('scrolled');
        } else {
            $header.removeClass('scrolled');
        }
    });
    
    $('.submenu-toggle').click(function(e) {
    	let $this    = $(this);
    	let $submenu = $this.next('.sub-menu');
    	
    	$('.sub-menu').not($submenu).slideUp();
    	$submenu.slideToggle();
    });
});
</script>
</html>